package tcs.lbs.notes_exploit;

import androidx.appcompat.app.AppCompatActivity;

import android.content.ComponentName;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.widget.EditText;
import android.widget.Toast;
import android.content.Context;


public class MainActivity extends AppCompatActivity
{

    EditText editText;


    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }


    public void addClicked(android.view.View view)
    {
        editText = findViewById(R.id.add_editText);

        // Toast.makeText(this, "Not Implemented Yet!!", Toast.LENGTH_SHORT).show();
        // TODO Implement functionality to read a text from 'editText' and add it to the database of notes app

        String noteText = editText.getText().toString();

        Intent intent = new Intent();
        intent.setComponent(new ComponentName("tcs.lbs.notes", "tcs.lbs.notes.DataBaseActivity"));
        intent.putExtra("ACTION_NAME", "SAVE_ITEM");
        intent.putExtra("NOTE_ID", "NEW_ID"); // Assuming you're adding a new note
        intent.putExtra("NOTE_TEXT", noteText); // Replace this with the actual note text
        startActivity(intent);
    }

    public void removeClicked(android.view.View view)
    {
        editText = findViewById(R.id.remove_editText);

        // MODIFIED: COMMENTED NEXT LINE
        // Toast.makeText(this, "Not Implemented Yet!!", Toast.LENGTH_SHORT).show();
        // TODO Implement functionality to read a note's ID from 'editText' and remove that note from database

        String noteId = editText.getText().toString();

        Intent intent = new Intent();
        intent.setComponent(new ComponentName("tcs.lbs.notes", "tcs.lbs.notes.DataBaseActivity"));
        intent.putExtra("ACTION_NAME", "DELETE_ITEM");
        intent.putExtra("NOTE_ID", noteId);
        startActivity(intent);


    }

    public void showClicked(android.view.View view)
    {
        editText = findViewById(R.id.show_editText);

        // Toast.makeText(this, "Not Implemented Yet!!", Toast.LENGTH_SHORT).show();
        // TODO Implement functionality to read a note's ID from 'editText' and show the text of that note in a Toast Message

        String noteId = editText.getText().toString(); // Get the note ID from the EditText

        // Create and start the Intent to retrieve the note text
        Intent intent = new Intent();
        intent.setComponent(new ComponentName("tcs.lbs.notes", "tcs.lbs.notes.DataBaseActivity"));
        intent.putExtra("ACTION_NAME", "GET_ITEM_TEXT");
        intent.putExtra("NOTE_ID", noteId); // Use the note ID from the EditText
        startActivityForResult(intent, 1); // Start the activity and expect a result
    }
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);

        if (requestCode == 1) { // Check if the result is from the correct request
            if (resultCode == RESULT_OK) { // Check if the operation was successful
                String noteText = data.getStringExtra("ITEM_TEXT"); // Get the returned note text
                // Show the note text in a Toast message
                Toast.makeText(this, noteText, Toast.LENGTH_SHORT).show();
            } else {
                Toast.makeText(this, "Failed to retrieve note text", Toast.LENGTH_SHORT).show();
            }
        }
    }
}

